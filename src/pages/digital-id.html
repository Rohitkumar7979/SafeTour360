<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Digital Tourist ID - SafeTour360°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <script src="../js/script.js"></script>
    <script src="../js/digital-id.js"></script>

</head>
<body class="bg-slate-900">
    <!-- Enhanced Navbar -->
    <nav class="bg-slate-800/95 backdrop-blur-md shadow-2xl fixed w-full top-0 z-50 border-b border-slate-600">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <!-- Logo Section -->
                <div class="flex items-center">
                    <a href="../index.html" class="flex items-center hover:scale-105 transition duration-300">
                        <i class="fas fa-shield-alt text-blue-400 text-2xl mr-2"></i>
                        <span class="text-xl font-bold text-slate-100">SafeTour360°</span>
                    </a>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-1">
                    <a href="index.html" class="nav-link text-slate-300 hover:text-blue-400 font-medium transition duration-300 px-4 py-2 rounded-lg hover:bg-slate-700">
                        <i class="fas fa-home mr-2"></i>Home
                    </a>
                    <a href="tourist.html" class="nav-link text-slate-300 hover:text-blue-400 font-medium transition duration-300 px-4 py-2 rounded-lg hover:bg-slate-700">
                        <i class="fas fa-user mr-2"></i>Tourists
                    </a>
                    <a href="dashboard.html" class="nav-link text-slate-300 hover:text-blue-400 font-medium transition duration-300 px-4 py-2 rounded-lg hover:bg-slate-700">
                        <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                    </a>
                    <a href="digital-id.html" class="nav-link active text-blue-400 font-medium transition duration-300 px-4 py-2 rounded-lg bg-slate-700">
                        <i class="fas fa-id-card mr-2"></i>Digital ID
                    </a>
                    <a href="index.html#contact" class="nav-link text-slate-300 hover:text-blue-400 font-medium transition duration-300 px-4 py-2 rounded-lg hover:bg-slate-700">
                        <i class="fas fa-envelope mr-2"></i>Contact
                    </a>
                </div>

                <!-- Mobile Menu Button -->
                <button class="md:hidden text-slate-300 hover:text-blue-400 p-2 rounded-lg hover:bg-slate-700 transition duration-300" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
            
            <!-- Enhanced Mobile Menu -->
            <div id="mobileMenu" class="hidden md:hidden bg-slate-800/95 backdrop-blur-md border-t border-slate-600 rounded-b-lg shadow-xl">
                <div class="px-4 pt-4 pb-6 space-y-2">
                    <a href="../index.html" class="mobile-nav-link text-slate-300 hover:text-blue-400 block px-4 py-3 rounded-lg text-base font-medium transition duration-300 hover:bg-slate-700">
                        <i class="fas fa-home mr-3"></i>Home
                    </a>
                    <a href="tourist.html" class="mobile-nav-link text-slate-300 hover:text-blue-400 block px-4 py-3 rounded-lg text-base font-medium transition duration-300 hover:bg-slate-700">
                        <i class="fas fa-user mr-3"></i>Tourists
                    </a>
                    <a href="dashboard.html" class="mobile-nav-link text-slate-300 hover:text-blue-400 block px-4 py-3 rounded-lg text-base font-medium transition duration-300 hover:bg-slate-700">
                        <i class="fas fa-tachometer-alt mr-3"></i>Dashboard
                    </a>
                    <a href="digital-id.html" class="mobile-nav-link active text-blue-400 block px-4 py-3 rounded-lg text-base font-medium bg-slate-700">
                        <i class="fas fa-id-card mr-3"></i>Digital ID
                    </a>
                    <a href="../index.html#contact" class="mobile-nav-link text-slate-300 hover:text-blue-400 block px-4 py-3 rounded-lg text-base font-medium transition duration-300 hover:bg-slate-700">
                        <i class="fas fa-envelope mr-3"></i>Contact
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="pt-24 min-h-screen bg-slate-900">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-700 py-16">
            <div class="max-w-4xl mx-auto px-4 text-center">
                <h1 class="text-4xl font-bold text-white mb-4">Generate Your Digital Tourist ID</h1>
                <p class="text-xl text-blue-100 mb-6">Secure, blockchain-based identity for safe travel across India</p>
                <div class="flex justify-center items-center space-x-8">
                    <div class="text-center">
                        <i class="fas fa-shield-alt text-3xl text-yellow-300 mb-2"></i>
                        <p class="text-sm text-blue-100">Secure</p>
                    </div>
                    <div class="text-center">
                        <i class="fas fa-clock text-3xl text-yellow-300 mb-2"></i>
                        <p class="text-sm text-blue-100">Quick</p>
                    </div>
                    <div class="text-center">
                        <i class="fas fa-check-circle text-3xl text-yellow-300 mb-2"></i>
                        <p class="text-sm text-blue-100">Verified</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Form Section -->
        <div class="max-w-4xl mx-auto px-4 py-12">
            <!-- Progress Steps -->
            <div class="mb-12">
                <div class="flex justify-center items-center space-x-4">
                    <div class="flex items-center">
                        <div class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold">1</div>
                        <span class="ml-2 text-slate-300">Personal Info</span>
                    </div>
                    <div class="flex-1 h-px bg-slate-600"></div>
                    <div class="flex items-center">
                        <div class="bg-slate-600 text-slate-400 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold">2</div>
                        <span class="ml-2 text-slate-500">Travel Details</span>
                    </div>
                    <div class="flex-1 h-px bg-slate-600"></div>
                    <div class="flex items-center">
                        <div class="bg-slate-600 text-slate-400 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold">3</div>
                        <span class="ml-2 text-slate-500">Verification</span>
                    </div>
                </div>
            </div>

            <!-- Main Form -->
            <form id="touristRegistrationForm" class="space-y-8">
                <!-- Personal Information Section -->
                <div id="step1" class="bg-slate-800 rounded-xl p-8 border border-slate-600">
                    <h2 class="text-2xl font-bold text-slate-100 mb-6 flex items-center">
                        <i class="fas fa-user text-blue-400 mr-3"></i>Personal Information
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Profile Photo Upload -->
                        <div class="md:col-span-2 flex justify-center mb-6">
                            <div class="relative">
                                <div id="photoPreview" class="w-32 h-32 bg-slate-700 border-2 border-dashed border-slate-500 rounded-full flex items-center justify-center cursor-pointer hover:border-blue-400 transition duration-300">
                                    <div class="text-center">
                                        <i class="fas fa-camera text-slate-400 text-2xl mb-2"></i>
                                        <p class="text-slate-400 text-sm">Upload Photo</p>
                                    </div>
                                </div>
                                <input type="file" id="profilePhoto" accept="image/*" class="hidden" onchange="previewPhoto(event)">
                                <button type="button" onclick="document.getElementById('profilePhoto').click()" class="absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white rounded-full w-8 h-8 flex items-center justify-center">
                                    <i class="fas fa-plus text-sm"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Full Name -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-user mr-2"></i>Full Name *
                            </label>
                            <input type="text" id="fullName" name="fullName" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                   placeholder="Enter your full name">
                        </div>

                        <!-- Date of Birth -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-birthday-cake mr-2"></i>Date of Birth *
                            </label>
                            <input type="date" id="dateOfBirth" name="dateOfBirth" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                        </div>

                        <!-- Gender -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-venus-mars mr-2"></i>Gender *
                            </label>
                            <select id="gender" name="gender" required 
                                    class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <!-- Nationality -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-flag mr-2"></i>Nationality *
                            </label>
                            <select id="nationality" name="nationality" required 
                                    class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                <option value="">Select Nationality</option>
                                <option value="indian">Indian</option>
                                <option value="american">American</option>
                                <option value="british">British</option>
                                <option value="canadian">Canadian</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <!-- Email -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-envelope mr-2"></i>Email Address *
                            </label>
                            <input type="email" id="email" name="email" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                   placeholder="your.email@example.com">
                        </div>

                        <!-- Phone -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-phone mr-2"></i>Phone Number *
                            </label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                   placeholder="+91 98765 43210">
                        </div>

                        <!-- Aadhaar Number -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-id-card mr-2"></i>Aadhaar Number *
                            </label>
                            <input type="text" id="aadhaarNumber" name="aadhaarNumber" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                   placeholder="1234 5678 9012"
                                   maxlength="14" oninput="formatAadhaar(this)">
                        </div>

                        <!-- Passport Number (Optional) -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-passport mr-2"></i>Passport Number (Optional)
                            </label>
                            <input type="text" id="passportNumber" name="passportNumber" 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                   placeholder="A1234567">
                        </div>

                        <!-- Address -->
                        <div class="md:col-span-2">
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-map-marker-alt mr-2"></i>Current Address *
                            </label>
                            <textarea id="address" name="address" required rows="3"
                                      class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                      placeholder="Enter your complete address"></textarea>
                        </div>
                    </div>

                    <div class="flex justify-end mt-8">
                        <button type="button" onclick="nextStep()" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                            <i class="fas fa-arrow-right mr-2"></i>Next: Travel Details
                        </button>
                    </div>
                </div>

                <!-- Travel Information Section -->
                <div id="step2" class="hidden bg-slate-800 rounded-xl p-8 border border-slate-600">
                    <h2 class="text-2xl font-bold text-slate-100 mb-6 flex items-center">
                        <i class="fas fa-plane text-green-400 mr-3"></i>Travel Information
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Destination -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-map-marked-alt mr-2"></i>Primary Destination *
                            </label>
                            <select id="destination" name="destination" required 
                                    class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                <option value="">Select Destination</option>
                                <option value="northeast">Northeast India</option>
                                <option value="kashmir">Kashmir</option>
                                <option value="kerala">Kerala</option>
                                <option value="rajasthan">Rajasthan</option>
                                <option value="goa">Goa</option>
                                <option value="himachal">Himachal Pradesh</option>
                                <option value="uttarakhand">Uttarakhand</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <!-- Travel Purpose -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-question-circle mr-2"></i>Purpose of Travel *
                            </label>
                            <select id="travelPurpose" name="travelPurpose" required 
                                    class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                <option value="">Select Purpose</option>
                                <option value="tourism">Tourism</option>
                                <option value="business">Business</option>
                                <option value="pilgrimage">Pilgrimage</option>
                                <option value="medical">Medical</option>
                                <option value="education">Education</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <!-- Travel Start Date -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-calendar-alt mr-2"></i>Travel Start Date *
                            </label>
                            <input type="date" id="travelStartDate" name="travelStartDate" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                        </div>

                        <!-- Travel End Date -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-calendar-check mr-2"></i>Travel End Date *
                            </label>
                            <input type="date" id="travelEndDate" name="travelEndDate" required 
                                   class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                        </div>

                        <!-- Group Size -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-users mr-2"></i>Group Size *
                            </label>
                            <select id="groupSize" name="groupSize" required 
                                    class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                <option value="">Select Group Size</option>
                                <option value="solo">Solo (1 person)</option>
                                <option value="couple">Couple (2 people)</option>
                                <option value="small-group">Small Group (3-5 people)</option>
                                <option value="large-group">Large Group (6+ people)</option>
                            </select>
                        </div>

                        <!-- Accommodation Type -->
                        <div>
                            <label class="block text-slate-300 text-sm font-medium mb-2">
                                <i class="fas fa-bed mr-2"></i>Accommodation Type
                            </label>
                            <select id="accommodationType" name="accommodationType" 
                                    class="w-full p-4 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                <option value="">Select Accommodation</option>
                                <option value="hotel">Hotel</option>
                                <option value="homestay">Homestay</option>
                                <option value="guesthouse">Guesthouse</option>
                                <option value="camping">Camping</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <!-- Emergency Contact -->
                        <div class="md:col-span-2">
                            <h3 class="text-lg font-semibold text-slate-200 mb-4 flex items-center">
                                <i class="fas fa-phone-alt text-red-400 mr-2"></i>Emergency Contact Information
                            </h3>
                            
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-slate-300 text-sm font-medium mb-2">Contact Name *</label>
                                    <input type="text" id="emergencyContactName" name="emergencyContactName" required 
                                           class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                           placeholder="Emergency contact name">
                                </div>
                                <div>
                                    <label class="block text-slate-300 text-sm font-medium mb-2">Contact Phone *</label>
                                    <input type="tel" id="emergencyContactPhone" name="emergencyContactPhone" required 
                                           class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300"
                                           placeholder="Emergency contact phone">
                                </div>
                                <div>
                                    <label class="block text-slate-300 text-sm font-medium mb-2">Relationship</label>
                                    <select id="emergencyContactRelation" name="emergencyContactRelation" 
                                            class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:border-blue-400 focus:outline-none transition duration-300">
                                        <option value="">Select Relationship</option>
                                        <option value="parent">Parent</option>
                                        <option value="spouse">Spouse</option>
                                        <option value="sibling">Sibling</option>
                                        <option value="friend">Friend</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between mt-8">
                        <button type="button" onclick="prevStep()" class="bg-slate-600 hover:bg-slate-500 text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                            <i class="fas fa-arrow-left mr-2"></i>Previous
                        </button>
                        <button type="button" onclick="nextStep()" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                            <i class="fas fa-arrow-right mr-2"></i>Next: Verification
                        </button>
                    </div>
                </div>

                <!-- Verification Section -->
                <div id="step3" class="hidden bg-slate-800 rounded-xl p-8 border border-slate-600">
                    <h2 class="text-2xl font-bold text-slate-100 mb-6 flex items-center">
                        <i class="fas fa-shield-check text-purple-400 mr-3"></i>Verification & Agreement
                    </h2>
                    
                    <!-- Terms and Conditions -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-slate-200 mb-4">Terms & Conditions</h3>
                        <div class="bg-slate-700 p-4 rounded-lg border border-slate-600 max-h-60 overflow-y-auto">
                            <div class="text-sm text-slate-300 space-y-3">
                                <p><strong>1. Data Collection:</strong> By registering, you consent to the collection and processing of your personal data for tourism safety purposes.</p>
                                <p><strong>2. Location Tracking:</strong> Your location will be monitored during your trip for safety and emergency response purposes.</p>
                                <p><strong>3. Emergency Response:</strong> In case of emergency, your data may be shared with relevant authorities.</p>
                                <p><strong>4. Data Security:</strong> Your data is encrypted and stored securely on blockchain technology.</p>
                                <p><strong>5. Usage:</strong> This digital ID is valid only for the specified travel duration and purpose.</p>
                                <p><strong>6. Compliance:</strong> You agree to comply with local laws and regulations during your travel.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Consent Checkboxes -->
                    <div class="space-y-4 mb-8">
                        <div class="flex items-start">
                            <input type="checkbox" id="dataConsent" name="dataConsent" required 
                                   class="mt-1 w-4 h-4 text-blue-600 border-slate-600 rounded focus:ring-blue-500 focus:ring-2">
                            <label for="dataConsent" class="ml-3 text-slate-300 text-sm">
                                I consent to the collection, processing, and storage of my personal data for tourism safety purposes. *
                            </label>
                        </div>
                        
                        <div class="flex items-start">
                            <input type="checkbox" id="locationConsent" name="locationConsent" required 
                                   class="mt-1 w-4 h-4 text-blue-600 border-slate-600 rounded focus:ring-blue-500 focus:ring-2">
                            <label for="locationConsent" class="ml-3 text-slate-300 text-sm">
                                I agree to real-time location tracking during my travel for safety monitoring and emergency response. *
                            </label>
                        </div>
                        
                        <div class="flex items-start">
                            <input type="checkbox" id="termsConsent" name="termsConsent" required 
                                   class="mt-1 w-4 h-4 text-blue-600 border-slate-600 rounded focus:ring-blue-500 focus:ring-2">
                            <label for="termsConsent" class="ml-3 text-slate-300 text-sm">
                                I have read and agree to the Terms & Conditions and Privacy Policy. *
                            </label>
                        </div>
                        
                        <div class="flex items-start">
                            <input type="checkbox" id="accuracyConsent" name="accuracyConsent" required 
                                   class="mt-1 w-4 h-4 text-blue-600 border-slate-600 rounded focus:ring-blue-500 focus:ring-2">
                            <label for="accuracyConsent" class="ml-3 text-slate-300 text-sm">
                                I certify that all information provided is accurate and complete. *
                            </label>
                        </div>
                    </div>

                    <!-- Digital Signature -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-slate-200 mb-4">Digital Signature</h3>
                        <div class="bg-slate-700 p-4 rounded-lg border border-slate-600">
                            <canvas id="signaturePad" width="400" height="150" class="border border-slate-600 bg-white rounded cursor-crosshair"></canvas>
                            <div class="flex justify-between mt-3">
                                <button type="button" onclick="clearSignature()" class="text-sm bg-slate-600 hover:bg-slate-500 text-white px-4 py-2 rounded transition duration-300">
                                    <i class="fas fa-eraser mr-1"></i>Clear
                                </button>
                                <p class="text-xs text-slate-400">Please sign above</p>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button type="button" onclick="prevStep()" class="bg-slate-600 hover:bg-slate-500 text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                            <i class="fas fa-arrow-left mr-2"></i>Previous
                        </button>
                        <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                            <i class="fas fa-check mr-2"></i>Generate Digital ID
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/script.js"></script>
    <script src="../js/digital-id.js"></script>

    <script>
        // Multi-step form functionality
        let currentStep = 1;
        const totalSteps = 3;

        function nextStep() {
            if (validateCurrentStep()) {
                document.getElementById(`step${currentStep}`).classList.add('hidden');
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.remove('hidden');
                updateProgress();
            }
        }

        function prevStep() {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            currentStep--;
            document.getElementById(`step${currentStep}`).classList.remove('hidden');
            updateProgress();
        }

        function updateProgress() {
            // Update progress indicators
            for (let i = 1; i <= totalSteps; i++) {
                const stepElement = document.querySelector(`.flex.justify-center .flex:nth-child(${i * 2 - 1}) div`);
                const textElement = document.querySelector(`.flex.justify-center .flex:nth-child(${i * 2 - 1}) span`);
                
                if (i <= currentStep) {
                    stepElement.className = 'bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold';
                    textElement.className = 'ml-2 text-slate-200';
                } else {
                    stepElement.className = 'bg-slate-600 text-slate-400 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold';
                    textElement.className = 'ml-2 text-slate-500';
                }
            }
        }

        function validateCurrentStep() {
            const currentStepElement = document.getElementById(`step${currentStep}`);
            const requiredFields = currentStepElement.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!field.value.trim()) {
                    field.focus();
                    alert(`Please fill in the required field: ${field.previousElementSibling.textContent}`);
                    return false;
                }
            }
            return true;
        }

        // Aadhaar formatting
        function formatAadhaar(input) {
            let value = input.value.replace(/\D/g, '');
            value = value.replace(/(\d{4})(\d{4})(\d{4})/, '$1 $2 $3');
            input.value = value;
        }

        // Photo preview
        function previewPhoto(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('photoPreview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Profile" class="w-full h-full object-cover rounded-full">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Signature pad
        const canvas = document.getElementById('signaturePad');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);

        function startDrawing(e) {
            isDrawing = true;
            draw(e);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#000';
            
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(e.offsetX, e.offsetY);
        }

        function stopDrawing() {
            isDrawing = false;
            ctx.beginPath();
        }

        function clearSignature() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Form submission
        document.getElementById('touristRegistrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate all consents
            const consents = ['dataConsent', 'locationConsent', 'termsConsent', 'accuracyConsent'];
            for (let consent of consents) {
                if (!document.getElementById(consent).checked) {
                    alert('Please accept all terms and conditions to proceed.');
                    return;
                }
            }

            // Check if signature exists
            const imageData = canvas.toDataURL();
            if (imageData === document.createElement('canvas').toDataURL()) {
                alert('Please provide your digital signature.');
                return;
            }

            // Show loading and generate ID
            if (window.digitalIDSystem) {
                window.digitalIDSystem.generateDigitalId(e);
            } else {
                // Fallback functionality
                showLoadingAndSuccess();
            }
        });

        function showLoadingAndSuccess() {
            // Show loading modal
            const loadingModal = document.createElement('div');
            loadingModal.className = 'fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center';
            loadingModal.innerHTML = `
                <div class="bg-slate-700 rounded-xl p-8 text-center border border-slate-600 max-w-md mx-4">
                    <div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-400 border-t-transparent mx-auto mb-4"></div>
                    <h3 class="text-xl font-bold text-slate-100 mb-2">Generating Digital ID</h3>
                    <p class="text-slate-300">Processing blockchain transaction...</p>
                </div>
            `;
            document.body.appendChild(loadingModal);

            // Simulate processing time
            setTimeout(() => {
                loadingModal.remove();
                
                // Show success modal
                const successModal = document.createElement('div');
                successModal.className = 'fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center';
                successModal.innerHTML = `
                    <div class="bg-slate-700 rounded-xl p-8 text-center border border-slate-600 max-w-md mx-4">
                        <div class="text-green-400 mb-4">
                            <i class="fas fa-check-circle text-6xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-slate-100 mb-4">Digital ID Created Successfully!</h2>
                        <p class="text-slate-300 mb-6">Your tourist ID has been registered on the blockchain.</p>
                        <div class="bg-slate-800 rounded-lg p-4 mb-6 border border-slate-600">
                            <div class="text-lg font-bold text-blue-400">ST360-2025-${Math.floor(Math.random() * 999999).toString().padStart(6, '0')}</div>
                            <div class="text-sm text-slate-400">Your Digital Tourist ID</div>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                    class="flex-1 bg-slate-600 hover:bg-slate-500 text-white px-4 py-2 rounded-lg transition duration-300">
                                Close
                            </button>
                            <a href="tourist.html" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-300 inline-block text-center">
                                View Dashboard
                            </a>
                        </div>
                    </div>
                `;
                document.body.appendChild(successModal);
            }, 3000);
        }

        // Set minimum date to today
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('travelStartDate').min = today;
            
            // Update end date minimum when start date changes
            document.getElementById('travelStartDate').addEventListener('change', function() {
                document.getElementById('travelEndDate').min = this.value;
            });
        });
    </script>
</body>
</html>
